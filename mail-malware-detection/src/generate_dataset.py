"""
Generate a synthetic multilingual phishing dataset (English + Hindi)
Outputs a CSV with columns: subject, body, label (1=phishing, 0=benign)
Run: python generate_dataset.py --out ../data/raw/phishing_dataset.csv --n 5000
"""
import argparse
import random
import csv

ENGLISH_PHISH = [
    "Urgent: Verify your account",
    "Your account has been suspended",
    "Update payment information immediately",
    "Confirm your login",
    "Password reset required",
    "Claim your refund now",
    "Unusual sign-in attempt detected",
]
ENGLISH_BENIGN = [
    "Meeting agenda for tomorrow",
    "Weekly report attached",
    "Lunch plans",
    "Project update: milestones",
    "Invoice for your recent purchase",
    "Family photos from weekend",
]
HINDI_PHISH = [
    "कृपया अपना खाता सत्यापित करें",
    "आपका खाता निलंबित कर दिया गया है",
    "भुगतान जानकारी तुरंत अपडेट करें",
    "पासवर्ड रीसेट करें",
    "संदिग्ध लॉगिन का प्रयास देखा गया",
]
HINDI_BENIGN = [
    "आइए शुक्रवार को मिलते हैं",
    "सप्ताहिक रिपोर्ट संलग्न है",
    "छुट्टी की तस्वीरें साझा कर रहा हूँ",
]

PHISH_BODY_SNIPPETS = [
    "Click this link to verify: http://example.com/verify",
    "Please login immediately: http://bad.example/login",
    "We detected suspicious activity - confirm your identity",
    "Your payment failed. Update details here: http://pay.example/",
]
BENIGN_BODY_SNIPPETS = [
    "Please find the attached document for your review.",
    "Let's catch up later this week about the project.",
    "Here are the meeting notes from yesterday.",
]

HINDI_PHISH_BODY = [
    "कृपया इस लिंक पर क्लिक कर के सत्यापित करें: http://example.com/verify",
    "हमने संदिग्ध गतिविधि देखी, कृपया पुष्टि करें",
]

HINDI_BENIGN_BODY = [
    "यहाँ पिछली बैठक के नोट्स हैं।",
    "आपसे कल मिलने की आशा है।",
]


def make_sample(phish_probability=0.5):
    is_phish = random.random() < phish_probability
    # choose language: 80% English, 20% Hindi
    lang = 'en' if random.random() < 0.8 else 'hi'
    if is_phish:
        if lang == 'en':
            subject = random.choice(ENGLISH_PHISH)
            body = random.choice(PHISH_BODY_SNIPPETS)
        else:
            subject = random.choice(HINDI_PHISH)
            body = random.choice(HINDI_PHISH_BODY)
    else:
        if lang == 'en':
            subject = random.choice(ENGLISH_BENIGN)
            body = random.choice(BENIGN_BODY_SNIPPETS)
        else:
            subject = random.choice(HINDI_BENIGN)
            body = random.choice(HINDI_BENIGN_BODY)
    # Add small random noise
    if random.random() < 0.3:
        body += "\n\n" + random.choice(["Regards, Team", "Thanks", "-- Admin"]) 
    return subject, body, int(is_phish)


def generate(out_path, n=5000):
    with open(out_path, 'w', newline='', encoding='utf-8') as f:
        writer = csv.writer(f)
        writer.writerow(['subject', 'body', 'label'])
        for _ in range(n):
            subj, body, label = make_sample()
            writer.writerow([subj, body, label])


if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--out', default='data/raw/phishing_dataset.csv')
    parser.add_argument('--n', type=int, default=5000)
    args = parser.parse_args()
    generate(args.out, args.n)
    print(f"Generated {args.n} samples to {args.out}")
